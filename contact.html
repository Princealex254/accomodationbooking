<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Us - Prince Alex Airbnb, Uthiru</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; line-height: 1.6; color: #333; overflow-x: hidden; background: #f8f9fa; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        .navbar { position: fixed; top: 0; width: 100%; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); z-index: 1000; padding: 1rem 0; transition: all 0.3s ease; box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1); }
        .nav-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .nav-logo h2 { font-family: 'Montserrat', sans-serif; color: #1a365d; font-size: 1.5rem; font-weight: 600; }
        .nav-logo span { color: #d4af37; font-size: 0.9rem; font-weight: 400; }
        .nav-menu { display: flex; align-items: center; gap: 2rem; }
        .nav-link { text-decoration: none; color: #333; font-weight: 500; transition: color 0.3s ease; position: relative; }
        .nav-link:hover, .nav-link.active { color: #d4af37; }
        .nav-link.active::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 2px; background: #d4af37; }
        .login-btn { background: #d4af37; color: white !important; padding: 0.5rem 1.5rem; border-radius: 25px; transition: all 0.3s ease; }
        .login-btn:hover { background: #b8941f; transform: translateY(-2px); }
        
        .user-menu { position: relative; display: none; }
        .user-menu-btn { display: flex; align-items: center; gap: 0.5rem; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 25px; padding: 0.5rem 1rem; cursor: pointer; transition: all 0.3s ease; font-family: 'Poppins', sans-serif; font-weight: 500; color: #333; min-height: 44px; }
        .user-menu-btn:hover { background: #e9ecef; border-color: #d4af37; transform: translateY(-2px); }
        .user-menu-btn img { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; }
        .dropdown-arrow { font-size: 0.8rem; transition: transform 0.3s ease; }
        .user-menu-btn:hover .dropdown-arrow { transform: rotate(180deg); }
        .user-dropdown { position: absolute; top: 100%; right: 0; background: white; border: 1px solid #e9ecef; border-radius: 10px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1); min-width: 200px; z-index: 1000; display: none; margin-top: 0.5rem; }
        .dropdown-item { display: flex; align-items: center; gap: 0.8rem; padding: 1rem; text-decoration: none; color: #333; transition: background-color 0.3s ease; border-bottom: 1px solid #f8f9fa; min-height: 44px; }
        .dropdown-item:hover { background: #f8f9fa; color: #d4af37; }
        .dropdown-item:last-child { border-bottom: none; }
        .item-icon { font-size: 1.2rem; width: 20px; text-align: center; }
        
        .hamburger { display: none; flex-direction: column; cursor: pointer; z-index: 1001; }
        .hamburger span { width: 25px; height: 3px; background: #333; margin: 3px 0; transition: 0.3s; }
        .hamburger.active span:nth-child(1) { transform: rotate(-45deg) translate(-5px, 6px); }
        .hamburger.active span:nth-child(2) { opacity: 0; }
        .hamburger.active span:nth-child(3) { transform: rotate(45deg) translate(-5px, -6px); }
        
        .contact-hero { margin-top: 70px; padding: 4rem 0; background: linear-gradient(135deg, #1a365d, #2d5a87); color: white; text-align: center; }
        .contact-hero h1 { font-size: 3rem; font-weight: 700; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); }
        .contact-hero p { font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto; }
        
        .contact-section { padding: 4rem 0; }
        .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: start; }
        
        .contact-info { background: white; padding: 3rem; border-radius: 20px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); }
        .contact-info h2 { font-size: 2rem; color: #1a365d; margin-bottom: 2rem; }
        .contact-methods { display: flex; flex-direction: column; gap: 2rem; }
        .contact-method { display: flex; align-items: center; gap: 1.5rem; padding: 1.5rem; background: #f8f9fa; border-radius: 15px; transition: all 0.3s ease; }
        .contact-method:hover { background: #e9ecef; transform: translateY(-3px); }
        .contact-icon { font-size: 2rem; color: #d4af37; width: 60px; text-align: center; }
        .contact-details h3 { font-size: 1.2rem; color: #1a365d; margin-bottom: 0.5rem; }
        .contact-details p { color: #666; }
        .contact-details a { color: #d4af37; text-decoration: none; font-weight: 500; }
        .contact-details a:hover { text-decoration: underline; }
        
        .contact-form-container { background: white; padding: 3rem; border-radius: 20px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); }
        .contact-form-container h2 { font-size: 2rem; color: #1a365d; margin-bottom: 1rem; }
        .form-subtitle { color: #666; margin-bottom: 2rem; }
        .contact-form { display: flex; flex-direction: column; gap: 1.5rem; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-group { display: flex; flex-direction: column; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-group label { font-weight: 500; color: #333; margin-bottom: 0.5rem; font-size: 0.9rem; }
        .form-group input, .form-group select, .form-group textarea { padding: 1rem; border: 2px solid #e9ecef; border-radius: 12px; font-size: 1rem; font-family: 'Poppins', sans-serif; transition: all 0.3s ease; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #d4af37; box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1); transform: translateY(-2px); }
        .form-group textarea { resize: vertical; min-height: 120px; }
        .form-group.required label::after { content: ' *'; color: #dc3545; }
        
        .submit-btn { background: linear-gradient(135deg, #d4af37, #b8941f); color: white; border: none; padding: 1.2rem 2rem; border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 1rem; }
        .submit-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3); }
        .submit-btn:disabled { opacity: 0.7; cursor: not-allowed; transform: none; }
        
        .quick-actions { margin-top: 3rem; }
        .quick-actions h3 { font-size: 1.5rem; color: #1a365d; margin-bottom: 1.5rem; text-align: center; }
        .actions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; }
        .action-card { background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08); text-align: center; transition: all 0.3s ease; }
        .action-card:hover { transform: translateY(-5px); box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15); }
        .action-icon { font-size: 2.5rem; color: #d4af37; margin-bottom: 1rem; }
        .action-card h4 { font-size: 1.2rem; color: #1a365d; margin-bottom: 1rem; }
        .action-card p { color: #666; margin-bottom: 1.5rem; }
        .action-btn { background: #d4af37; color: white; border: none; padding: 0.8rem 1.5rem; border-radius: 25px; text-decoration: none; font-weight: 500; display: inline-block; transition: all 0.3s ease; }
        .action-btn:hover { background: #b8941f; transform: translateY(-2px); }
        
        .location-section { background: white; padding: 4rem 0; }
        .location-content { display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: center; }
        .location-info h3 { font-size: 2rem; color: #1a365d; margin-bottom: 1rem; }
        .location-info p { color: #666; font-size: 1.1rem; line-height: 1.8; margin-bottom: 1.5rem; }
        .location-features { list-style: none; }
        .location-features li { display: flex; align-items: center; gap: 0.8rem; margin-bottom: 0.8rem; color: #666; }
        .location-features li::before { content: 'üìç'; font-size: 1.2rem; }
        .location-map { background: linear-gradient(135deg, #e9ecef, #f8f9fa); height: 300px; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: #666; border: 2px dashed #d4af37; }
        
        .modal { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); }
        .modal-content { position: relative; background-color: white; margin: 10% auto; padding: 2rem; width: 90%; max-width: 500px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2); text-align: center; }
        .close-modal { position: absolute; top: 1rem; right: 1.5rem; font-size: 2rem; cursor: pointer; color: #666; }
        .close-modal:hover { color: #333; }
        .success-icon { font-size: 4rem; color: #28a745; margin-bottom: 1rem; }
        .modal h3 { color: #28a745; font-size: 1.5rem; margin-bottom: 1rem; }
        .modal p { color: #666; margin-bottom: 1.5rem; }
        .modal-btn { background: #d4af37; color: white; border: none; padding: 1rem 2rem; border-radius: 8px; cursor: pointer; font-weight: 500; }
        .modal-btn:hover { background: #b8941f; }
        
        .footer { background: #1a1a1a; color: white; padding: 3rem 0 1rem; }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem; }
        .footer-section h3, .footer-section h4 { margin-bottom: 1rem; color: #d4af37; }
        .footer-section p, .footer-section li { margin-bottom: 0.5rem; opacity: 0.8; }
        .footer-section ul { list-style: none; }
        .footer-section a { color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s ease; }
        .footer-section a:hover { opacity: 1; color: #d4af37; }
        .social-links { display: flex; gap: 1rem; margin-top: 1rem; }
        .social-links a { font-size: 1.5rem; transition: transform 0.3s ease; }
        .social-links a:hover { transform: scale(1.2); }
        .footer-bottom { text-align: center; padding-top: 2rem; border-top: 1px solid #333; opacity: 0.6; }
        .designer-credit { margin-top: 0.5rem; font-size: 0.9rem; }
        .designer-credit a { color: #d4af37; text-decoration: none; font-weight: 500; transition: all 0.3s ease; }
        .designer-credit a:hover { color: #b8941f; text-decoration: underline; }
        
        @media (max-width: 1024px) { .contact-grid, .location-content { grid-template-columns: 1fr; } .form-row { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { 
            .hamburger { display: flex; } 
            .nav-menu { position: fixed; left: -100%; top: 70px; flex-direction: column; background: white; width: 100%; text-align: center; transition: 0.3s; box-shadow: 0 10px 27px rgba(0, 0, 0, 0.05); padding: 2rem 0; } 
            .nav-menu.active { left: 0; } 
            .contact-hero h1 { font-size: 2.5rem; } 
            .actions-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 480px) { .container { padding: 0 15px; } .contact-info, .contact-form-container { padding: 2rem; } .contact-hero h1 { font-size: 2rem; } }
        
        html { scroll-behavior: smooth; }
        @media (max-width: 768px) { button, .btn, .submit-btn, .action-btn, input[type="submit"], input[type="button"] { min-height: 44px; touch-action: manipulation; } body { font-size: 16px; -webkit-text-size-adjust: 100%; } input, select, textarea { font-size: 16px; } }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>Prince Alex Airbnb</h2>
                <span>Uthiru, Nairobi</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="listings.html" class="nav-link">Rooms</a>
                <a href="about.html" class="nav-link">About</a>
                <a href="contact.html" class="nav-link active">Contact</a>
                <a href="login.html" class="nav-link login-btn" id="login-nav-btn">Login</a>
                <div class="user-menu" id="user-menu" style="display: none;">
                    <button class="user-menu-btn" onclick="toggleUserMenu()">
                        <img id="user-avatar" src="images/prince-alex.png" alt="User Avatar">
                        <span id="user-name">Guest</span>
                        <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <div class="user-dropdown" id="user-dropdown">
                        <a href="profile.html" class="dropdown-item">
                            <span class="item-icon">üë§</span>
                            <span>My Profile</span>
                        </a>
                        <a href="listings.html" class="dropdown-item">
                            <span class="item-icon">üè†</span>
                            <span>Browse Rooms</span>
                        </a>
                        <button onclick="logout()" class="dropdown-item" style="background: none; border: none; width: 100%; text-align: left; cursor: pointer;">
                            <span class="item-icon">üö™</span>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="hamburger"><span></span><span></span><span></span></div>
        </div>
    </nav>

    <section class="contact-hero">
        <div class="container">
            <h1>Get in Touch</h1>
            <p>We're here to help make your stay in Uthiru, Nairobi unforgettable. Reach out to us anytime!</p>
        </div>
    </section>

    <section class="contact-section">
        <div class="container">
            <div class="contact-grid">
                <div class="contact-info">
                    <h2>Contact Information</h2>
                    <div class="contact-methods">
                        <div class="contact-method">
                            <div class="contact-icon">üìû</div>
                            <div class="contact-details">
                                <h3>Phone</h3>
                                <p><a href="tel:+254717384875">+254 717 384 875</a></p>
                                <p>Available 24/7 for urgent inquiries</p>
                            </div>
                        </div>
                        
                        <div class="contact-method">
                            <div class="contact-icon">‚úâÔ∏è</div>
                            <div class="contact-details">
                                <h3>Email</h3>
                                <p><a href="mailto:princealexdigital@gmail.com">princealexdigital@gmail.com</a></p>
                                <p>We'll respond within 24 hours</p>
                            </div>
                        </div>
                        
                        <div class="contact-method">
                            <div class="contact-icon">üì±</div>
                            <div class="contact-details">
                                <h3>WhatsApp</h3>
                                <p><a href="https://wa.me/254717384875" target="_blank">+254 717 384 875</a></p>
                                <p>Quick responses and instant booking</p>
                            </div>
                        </div>
                        
                        <div class="contact-method">
                            <div class="contact-icon">üìç</div>
                            <div class="contact-details">
                                <h3>Location</h3>
                                <p>Uthiru, Nairobi, Kenya</p>
                                <p>15 minutes from Nairobi CBD</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="contact-form-container">
                    <h2>Send us a Message</h2>
                    <p class="form-subtitle">Fill out the form below and we'll get back to you as soon as possible</p>
                    
                    <form id="contact-form" class="contact-form">
                        <div class="form-row">
                            <div class="form-group required">
                                <label for="firstName">First Name</label>
                                <input type="text" id="firstName" name="firstName" required>
                            </div>
                            <div class="form-group required">
                                <label for="lastName">Last Name</label>
                                <input type="text" id="lastName" name="lastName" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group required">
                                <label for="email">Email Address</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone Number</label>
                                <input type="tel" id="phone" name="phone" placeholder="+254 717 384 875">
                            </div>
                        </div>
                        
                        <div class="form-group required">
                            <label for="subject">Subject</label>
                            <select id="subject" name="subject" required>
                                <option value="">Select a subject</option>
                                <option value="booking-inquiry">Booking Inquiry</option>
                                <option value="existing-booking">Existing Booking</option>
                                <option value="room-information">Room Information</option>
                                <option value="payment-billing">Payment & Billing</option>
                                <option value="feedback">Feedback & Reviews</option>
                                <option value="complaint">Complaint</option>
                                <option value="general">General Inquiry</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        
                        <div class="form-group full-width required">
                            <label for="message">Message</label>
                            <textarea id="message" name="message" placeholder="Tell us how we can help you..." required></textarea>
                        </div>
                        
                        <button type="submit" class="submit-btn">
                            <span id="submit-text">Send Message</span>
                            <span id="submit-loading" style="display: none;">Sending...</span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <section class="quick-actions">
        <div class="container">
            <h3>Quick Actions</h3>
            <div class="actions-grid">
                <div class="action-card">
                    <div class="action-icon">üè†</div>
                    <h4>Book a Room</h4>
                    <p>Browse our available rooms and make a reservation instantly</p>
                    <a href="listings.html" class="action-btn">View Rooms</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">üì±</div>
                    <h4>WhatsApp Us</h4>
                    <p>Get instant responses to your questions via WhatsApp</p>
                    <a href="https://wa.me/254717384875?text=Hi! I'm interested in booking a room at Prince Alex Airbnb." target="_blank" class="action-btn">Chat Now</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">üìû</div>
                    <h4>Call Direct</h4>
                    <p>Speak directly with Prince Alex for personalized assistance</p>
                    <a href="tel:+254717384875" class="action-btn">Call Now</a>
                </div>
                
                <div class="action-card">
                    <div class="action-icon">üë§</div>
                    <h4>My Account</h4>
                    <p>Manage your bookings and profile information</p>
                    <a href="profile.html" class="action-btn">My Profile</a>
                </div>
            </div>
        </div>
    </section>

    <section class="location-section">
        <div class="container">
            <div class="location-content">
                <div class="location-info">
                    <h3>Find Us in Uthiru</h3>
                    <p>Prince Alex Airbnb is conveniently located in the heart of Uthiru, offering easy access to Nairobi's main attractions while providing a peaceful residential environment.</p>
                    <ul class="location-features">
                        <li>15 minutes drive to Nairobi CBD</li>
                        <li>Close to public transportation</li>
                        <li>Walking distance to local markets</li>
                        <li>Safe and secure neighborhood</li>
                        <li>Easy access to major highways</li>
                        <li>Shopping centers nearby</li>
                    </ul>
                </div>
                <div class="location-map">
                    <div>
                        <p>üìç Interactive Map Coming Soon</p>
                        <p>Uthiru, Nairobi, Kenya</p>
                        <p>GPS: Available upon booking confirmation</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="success-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeSuccessModal()">&times;</span>
            <div class="success-icon">‚úÖ</div>
            <h3>Message Sent Successfully!</h3>
            <p>Thank you for contacting Prince Alex Airbnb. We've received your message and will respond within 24 hours.</p>
            <button class="modal-btn" onclick="closeSuccessModal()">Close</button>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Prince Alex Airbnb</h3>
                    <p>Your home away from home in Uthiru, Nairobi</p>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook">üìò</a>
                        <a href="#" aria-label="Instagram">üì∑</a>
                        <a href="#" aria-label="WhatsApp">üì±</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="listings.html">Rooms</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <p>üìç Uthiru, Nairobi, Kenya</p>
                    <p>üìû +254 717 384 875</p>
                    <p>‚úâÔ∏è princealexdigital@gmail.com</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Prince Alex Airbnb. All rights reserved.</p>
                <p class="designer-credit">Designed by <a href="https://www.princealex.pro" target="_blank" rel="noopener">Prince Alex Digital</a></p>
            </div>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    
    <script>
        const firebaseConfig = { apiKey: "AIzaSyAUNs3WYS2mkvPvzRDfhyZFUbP2XpZjDQg", authDomain: "retailflow-pos-11726.firebaseapp.com", projectId: "retailflow-pos-11726", storageBucket: "retailflow-pos-11726.firebasestorage.app", messagingSenderId: "309314798354", appId: "1:309314798354:web:30784c2b2e7e42168629cb" };
        let firebaseApp, auth, db, currentUser;

        function initializeFirebase() {
            if (typeof firebase !== 'undefined') {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                db = firebase.firestore();
                auth.onAuthStateChanged((user) => {
                    currentUser = user;
                    updateNavigationForAuthState(user);
                    if (user) {
                        prefillUserData(user);
                    }
                });
                return true;
            }
            return false;
        }

        function updateNavigationForAuthState(user) {
            const loginBtn = document.getElementById('login-nav-btn');
            const userMenu = document.getElementById('user-menu');
            
            if (user) {
                if (loginBtn) loginBtn.style.display = 'none';
                if (userMenu) {
                    userMenu.style.display = 'block';
                    const userName = document.getElementById('user-name');
                    const userAvatar = document.getElementById('user-avatar');
                    if (userName) {
                        const displayName = user.displayName || 'User';
                        userName.textContent = displayName.split(' ')[0];
                    }
                    if (userAvatar && user.photoURL) {
                        userAvatar.src = user.photoURL;
                    }
                }
            } else {
                if (loginBtn) loginBtn.style.display = 'inline-block';
                if (userMenu) userMenu.style.display = 'none';
            }
        }
        
        function toggleUserMenu() {
            const dropdown = document.getElementById('user-dropdown');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
            }
        }
        
        async function logout() {
            try {
                await auth.signOut();
                showNotification('üëã Successfully logged out', 'success');
                setTimeout(() => window.location.href = 'index.html', 1000);
            } catch (error) {
                console.error('Logout error:', error);
                showNotification('Error logging out. Please try again.', 'error');
            }
        }

        async function prefillUserData(user) {
            if (!user || !db) return;
            
            try {
                const userDoc = await db.collection('customers').doc(user.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    
                    if (userData.firstName) document.getElementById('firstName').value = userData.firstName;
                    if (userData.lastName) document.getElementById('lastName').value = userData.lastName;
                    if (userData.email) document.getElementById('email').value = userData.email;
                    if (userData.phone) document.getElementById('phone').value = userData.phone;
                    
                    console.log('‚úÖ User data pre-filled from profile');
                }
            } catch (error) {
                console.log('Note: Could not pre-fill user data:', error);
            }
        }

        function initializeMobileNavigation() {
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');
            const body = document.body;
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', function(e) {
                    e.stopPropagation();
                    navMenu.classList.toggle('active');
                    hamburger.classList.toggle('active');
                    body.style.overflow = navMenu.classList.contains('active') ? 'hidden' : 'auto';
                });
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', () => {
                        navMenu.classList.remove('active');
                        hamburger.classList.remove('active');
                        body.style.overflow = 'auto';
                    });
                });
                document.addEventListener('click', function(event) {
                    const userMenu = document.getElementById('user-menu');
                    const dropdown = document.getElementById('user-dropdown');
                    if (userMenu && dropdown && !userMenu.contains(event.target)) {
                        dropdown.style.display = 'none';
                    }
                });
            }
        }

        function initializeContactForm() {
            const form = document.getElementById('contact-form');
            form.addEventListener('submit', handleFormSubmit);
            
            const inputs = form.querySelectorAll('input[required], select[required], textarea[required]');
            inputs.forEach(input => {
                input.addEventListener('blur', validateField);
                input.addEventListener('input', clearFieldError);
            });
        }

        function validateField(event) {
            const field = event.target;
            const value = field.value.trim();
            
            clearFieldError(event);
            
            if (field.hasAttribute('required') && !value) {
                showFieldError(field, 'This field is required');
                return false;
            }
            
            if (field.type === 'email' && value) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(value)) {
                    showFieldError(field, 'Please enter a valid email address');
                    return false;
                }
            }
            
            if (field.type === 'tel' && value) {
                const phoneRegex = /^[\+]?[\d\s\-\(\)]+$/;
                if (!phoneRegex.test(value)) {
                    showFieldError(field, 'Please enter a valid phone number');
                    return false;
                }
            }
            
            return true;
        }

        function showFieldError(field, message) {
            field.style.borderColor = '#dc3545';
            field.style.boxShadow = '0 0 0 3px rgba(220, 53, 69, 0.1)';
            
            let errorElement = field.parentElement.querySelector('.field-error');
            if (!errorElement) {
                errorElement = document.createElement('span');
                errorElement.className = 'field-error';
                errorElement.style.cssText = 'color: #dc3545; font-size: 0.8rem; margin-top: 0.3rem; display: block;';
                field.parentElement.appendChild(errorElement);
            }
            errorElement.textContent = message;
        }

        function clearFieldError(event) {
            const field = event.target;
            field.style.borderColor = '#e9ecef';
            field.style.boxShadow = 'none';
            
            const errorElement = field.parentElement.querySelector('.field-error');
            if (errorElement) {
                errorElement.remove();
            }
        }

        async function handleFormSubmit(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            
            let isValid = true;
            const requiredFields = form.querySelectorAll('input[required], select[required], textarea[required]');
            requiredFields.forEach(field => {
                if (!validateField({ target: field })) {
                    isValid = false;
                }
            });
            
            if (!isValid) {
                showNotification('Please fill in all required fields correctly', 'error');
                return;
            }
            
            updateSubmitButton(true);
            
            try {
                const contactData = {
                    firstName: formData.get('firstName'),
                    lastName: formData.get('lastName'),
                    email: formData.get('email'),
                    phone: formData.get('phone') || null,
                    subject: formData.get('subject'),
                    message: formData.get('message'),
                    userId: currentUser ? currentUser.uid : null,
                    userEmail: currentUser ? currentUser.email : null,
                    status: 'new',
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    ipAddress: null,
                    userAgent: navigator.userAgent
                };
                
                const cleanData = {};
                Object.keys(contactData).forEach(key => {
                    if (contactData[key] !== null && contactData[key] !== undefined && contactData[key] !== '') {
                        cleanData[key] = contactData[key];
                    }
                });
                
                const docRef = await db.collection('contact-messages').add(cleanData);
                console.log('‚úÖ Contact message saved with ID:', docRef.id);
                
                showSuccessModal();
                form.reset();
                
            } catch (error) {
                console.error('‚ùå Error saving contact message:', error);
                showNotification('There was an error sending your message. Please try again or contact us directly.', 'error');
            }
            
            updateSubmitButton(false);
        }

        function updateSubmitButton(loading) {
            const submitBtn = document.querySelector('.submit-btn');
            const submitText = document.getElementById('submit-text');
            const submitLoading = document.getElementById('submit-loading');
            
            if (loading) {
                submitBtn.disabled = true;
                submitText.style.display = 'none';
                submitLoading.style.display = 'inline';
            } else {
                submitBtn.disabled = false;
                submitText.style.display = 'inline';
                submitLoading.style.display = 'none';
            }
        }

        function showSuccessModal() {
            document.getElementById('success-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeSuccessModal() {
            document.getElementById('success-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function showNotification(message, type = 'info') {
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `<div class="notification-content"><span class="notification-icon">${getNotificationIcon(type)}</span><span class="notification-message">${message}</span><button class="notification-close" onclick="this.parentElement.parentElement.remove()">&times;</button></div>`;
            notification.style.cssText = `position: fixed; top: 100px; right: 20px; background: ${getNotificationColor(type)}; color: white; padding: 1rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); z-index: 10000; min-width: 300px; max-width: 400px; animation: slideInRight 0.3s ease;`;
            const content = notification.querySelector('.notification-content');
            content.style.cssText = `display: flex; align-items: center; gap: 10px;`;
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.style.cssText = `background: none; border: none; color: white; font-size: 1.2rem; cursor: pointer; margin-left: auto; padding: 0 5px;`;
            document.body.appendChild(notification);
            setTimeout(() => { if (notification.parentElement) { notification.style.animation = 'slideOutRight 0.3s ease'; setTimeout(() => notification.remove(), 300); } }, 5000);
        }

        function getNotificationIcon(type) { switch(type) { case 'success': return '‚úì'; case 'error': return '‚úó'; case 'warning': return '‚ö†'; default: return '‚Ñπ'; } }
        function getNotificationColor(type) { switch(type) { case 'success': return '#28a745'; case 'error': return '#dc3545'; case 'warning': return '#ffc107'; default: return '#007bff'; } }

        document.addEventListener('DOMContentLoaded', function() {
            if (typeof firebase !== 'undefined') { initializeFirebase(); } else { setTimeout(() => initializeFirebase(), 1000); }
            initializeMobileNavigation();
            initializeContactForm();
        });

        window.addEventListener('click', function(event) {
            const modal = document.getElementById('success-modal');
            if (event.target === modal) {
                closeSuccessModal();
            }
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeSuccessModal();
            }
        });

        const style = document.createElement('style');
        style.textContent = `@keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } } @keyframes slideOutRight { from { transform: translateX(0); opacity: 1; } to { transform: translateX(100%); opacity: 0; } }`;
        document.head.appendChild(style);
    </script>
</body>
</html>
