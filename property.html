<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Details - Prince Alex Airbnb</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; line-height: 1.6; color: #333; background: #f8f9fa; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        .navbar { position: fixed; top: 0; width: 100%; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); z-index: 1000; padding: 1rem 0; box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1); }
        .nav-container { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .nav-logo h2 { font-family: 'Montserrat', sans-serif; color: #1a365d; font-size: 1.5rem; font-weight: 600; }
        .nav-logo span { color: #d4af37; font-size: 0.9rem; font-weight: 400; }
        .nav-menu { display: flex; align-items: center; gap: 2rem; }
        .nav-link { text-decoration: none; color: #333; font-weight: 500; transition: color 0.3s ease; position: relative; }
        .nav-link:hover, .nav-link.active { color: #d4af37; }
        .nav-link.active::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 2px; background: #d4af37; }
        .login-btn { background: #d4af37; color: white !important; padding: 0.5rem 1.5rem; border-radius: 25px; transition: all 0.3s ease; }
        .login-btn:hover { background: #b8941f; transform: translateY(-2px); }
        
        .user-menu { position: relative; display: none; }
        .user-menu-btn { display: flex; align-items: center; gap: 0.5rem; background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 25px; padding: 0.5rem 1rem; cursor: pointer; transition: all 0.3s ease; font-family: 'Poppins', sans-serif; font-weight: 500; color: #333; min-height: 44px; }
        .user-menu-btn:hover { background: #e9ecef; border-color: #d4af37; transform: translateY(-2px); }
        .user-menu-btn img { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; }
        .dropdown-arrow { font-size: 0.8rem; transition: transform 0.3s ease; }
        .user-menu-btn:hover .dropdown-arrow { transform: rotate(180deg); }
        .user-dropdown { position: absolute; top: 100%; right: 0; background: white; border: 1px solid #e9ecef; border-radius: 10px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1); min-width: 200px; z-index: 1000; display: none; margin-top: 0.5rem; }
        .dropdown-item { display: flex; align-items: center; gap: 0.8rem; padding: 1rem; text-decoration: none; color: #333; transition: background-color 0.3s ease; border-bottom: 1px solid #f8f9fa; min-height: 44px; }
        .dropdown-item:hover { background: #f8f9fa; color: #d4af37; }
        .dropdown-item:last-child { border-bottom: none; }
        .item-icon { font-size: 1.2rem; width: 20px; text-align: center; }
        
        .hamburger { display: none; flex-direction: column; cursor: pointer; z-index: 1001; }
        .hamburger span { width: 25px; height: 3px; background: #333; margin: 3px 0; transition: 0.3s; }
        .hamburger.active span:nth-child(1) { transform: rotate(-45deg) translate(-5px, 6px); }
        .hamburger.active span:nth-child(2) { opacity: 0; }
        .hamburger.active span:nth-child(3) { transform: rotate(45deg) translate(-5px, -6px); }
        
        .property-section { margin-top: 100px; padding: 2rem 0; }
        .breadcrumb { margin-bottom: 2rem; }
        .breadcrumb a { color: #666; text-decoration: none; margin-right: 0.5rem; }
        .breadcrumb a:hover { color: #d4af37; }
        .breadcrumb span { color: #333; font-weight: 500; }
        
        .property-content { display: grid; grid-template-columns: 2fr 1fr; gap: 3rem; }
        .property-main { background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08); }
        .property-sidebar { background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08); height: fit-content; position: sticky; top: 120px; }
        
        .property-gallery { margin-bottom: 2rem; }
        .main-image { width: 100%; height: 400px; border-radius: 15px; object-fit: cover; margin-bottom: 1rem; }
        .image-thumbnails { display: flex; gap: 1rem; overflow-x: auto; }
        .thumbnail { width: 100px; height: 80px; border-radius: 8px; object-fit: cover; cursor: pointer; transition: all 0.3s ease; opacity: 0.7; }
        .thumbnail:hover, .thumbnail.active { opacity: 1; border: 3px solid #d4af37; }
        
        .property-header { margin-bottom: 2rem; }
        .property-title { font-size: 2rem; font-weight: 600; color: #1a365d; margin-bottom: 0.5rem; }
        .property-location { color: #666; font-size: 1rem; margin-bottom: 1rem; }
        .property-rating { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
        .rating-stars { color: #ffc107; font-size: 1.1rem; }
        .rating-text { color: #666; }
        .property-price { font-size: 1.5rem; font-weight: 700; color: #d4af37; }
        
        .property-features { margin-bottom: 2rem; }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; }
        .feature-item { display: flex; align-items: center; gap: 0.5rem; padding: 0.8rem; background: #f8f9fa; border-radius: 8px; }
        .feature-icon { font-size: 1.2rem; }
        
        .property-description { margin-bottom: 2rem; }
        .section-title { font-size: 1.3rem; font-weight: 600; color: #1a365d; margin-bottom: 1rem; }
        .description-text { color: #666; line-height: 1.7; }
        
        .host-info { margin-bottom: 2rem; }
        .host-card { display: flex; align-items: center; gap: 1rem; padding: 1.5rem; background: #f8f9fa; border-radius: 10px; }
        .host-avatar { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; }
        .host-details h4 { font-size: 1.1rem; font-weight: 600; color: #1a365d; margin-bottom: 0.3rem; }
        .host-details p { color: #666; font-size: 0.9rem; }
        
        .booking-card { background: white; }
        .booking-header { margin-bottom: 1.5rem; }
        .booking-price { font-size: 1.5rem; font-weight: 700; color: #d4af37; margin-bottom: 0.5rem; }
        .price-period { color: #666; font-size: 0.9rem; }
        
        .booking-form { margin-bottom: 1.5rem; }
        .date-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-weight: 500; color: #333; margin-bottom: 0.5rem; font-size: 0.9rem; }
        .input-group input, .input-group select { padding: 0.8rem; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem; transition: all 0.3s ease; }
        .input-group input:focus, .input-group select:focus { outline: none; border-color: #d4af37; box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1); }
        
        .price-breakdown { background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; }
        .price-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem; }
        .price-row:last-child { border-top: 1px solid #ddd; padding-top: 0.8rem; margin-top: 0.8rem; font-weight: 600; }
        .price-label { color: #666; }
        .price-value { font-weight: 600; color: #333; }
        .total-price { color: #d4af37 !important; }
        
        .book-btn { width: 100%; background: linear-gradient(135deg, #d4af37, #b8941f); color: white; border: none; padding: 1.2rem; border-radius: 10px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-bottom: 1rem; }
        .book-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(212, 175, 55, 0.3); }
        
        .booking-note { font-size: 0.8rem; color: #666; text-align: center; }
        
        .footer { background: #1a1a1a; color: white; padding: 3rem 0 1rem; margin-top: 3rem; }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem; }
        .footer-section h3, .footer-section h4 { margin-bottom: 1rem; color: #d4af37; }
        .footer-section p, .footer-section li { margin-bottom: 0.5rem; opacity: 0.8; }
        .footer-section ul { list-style: none; }
        .footer-section a { color: white; text-decoration: none; opacity: 0.8; transition: opacity 0.3s ease; }
        .footer-section a:hover { opacity: 1; color: #d4af37; }
        .social-links { display: flex; gap: 1rem; margin-top: 1rem; }
        .social-links a { font-size: 1.5rem; transition: transform 0.3s ease; }
        .social-links a:hover { transform: scale(1.2); }
        .footer-bottom { text-align: center; padding-top: 2rem; border-top: 1px solid #333; opacity: 0.6; }
        .designer-credit { margin-top: 0.5rem; font-size: 0.9rem; }
        .designer-credit a { color: #d4af37; text-decoration: none; font-weight: 500; transition: all 0.3s ease; }
        .designer-credit a:hover { color: #b8941f; text-decoration: underline; }
        
        @media (max-width: 1024px) { .property-content { grid-template-columns: 1fr; } .property-sidebar { position: static; } }
        @media (max-width: 768px) { 
            .hamburger { display: flex; } 
            .nav-menu { position: fixed; left: -100%; top: 70px; flex-direction: column; background: white; width: 100%; text-align: center; transition: 0.3s; box-shadow: 0 10px 27px rgba(0, 0, 0, 0.05); padding: 2rem 0; } 
            .nav-menu.active { left: 0; } 
            .date-inputs { grid-template-columns: 1fr; } 
            .features-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 480px) { .container { padding: 0 15px; } .property-main, .property-sidebar { padding: 1.5rem; } .property-title { font-size: 1.5rem; } }
        
        html { scroll-behavior: smooth; }
        @media (max-width: 768px) { button, .btn, .book-btn, input[type="submit"], input[type="button"] { min-height: 44px; touch-action: manipulation; } body { font-size: 16px; -webkit-text-size-adjust: 100%; } input, select, textarea { font-size: 16px; } }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>Prince Alex Airbnb</h2>
                <span>Uthiru, Nairobi</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="listings.html" class="nav-link active">Rooms</a>
                <a href="about.html" class="nav-link">About</a>
                <a href="contact.html" class="nav-link">Contact</a>
                <a href="login.html" class="nav-link login-btn" id="login-nav-btn">Login</a>
                <div class="user-menu" id="user-menu" style="display: none;">
                    <button class="user-menu-btn" onclick="toggleUserMenu()">
                        <img id="user-avatar" src="images/prince-alex.png" alt="User Avatar">
                        <span id="user-name">Guest</span>
                        <span class="dropdown-arrow">‚ñº</span>
                    </button>
                    <div class="user-dropdown" id="user-dropdown">
                        <a href="profile.html" class="dropdown-item">
                            <span class="item-icon">üë§</span>
                            <span>My Profile</span>
                        </a>
                        <a href="listings.html" class="dropdown-item">
                            <span class="item-icon">üè†</span>
                            <span>Browse Rooms</span>
                        </a>
                        <a href="admin.html" class="dropdown-item">
                            <span class="item-icon">‚öôÔ∏è</span>
                            <span>Admin Dashboard</span>
                        </a>
                        <button onclick="logout()" class="dropdown-item" style="background: none; border: none; width: 100%; text-align: left; cursor: pointer;">
                            <span class="item-icon">üö™</span>
                            <span>Logout</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="hamburger"><span></span><span></span><span></span></div>
        </div>
    </nav>

    <section class="property-section">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html">Home</a> / 
                <a href="listings.html">Rooms</a> / 
                <span id="room-breadcrumb">Room Details</span>
            </div>
            
            <div class="property-content">
                <div class="property-main">
                    <div class="property-gallery">
                        <img id="main-image" src="" alt="Room Image" class="main-image">
                        <div class="image-thumbnails" id="image-thumbnails">
                            <!-- Thumbnails will be loaded here -->
                        </div>
                    </div>
                    
                    <div class="property-header">
                        <h1 class="property-title" id="room-title">Loading...</h1>
                        <p class="property-location">üìç Uthiru, Nairobi, Kenya</p>
                        <div class="property-rating">
                            <span class="rating-stars" id="room-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                            <span class="rating-text" id="rating-text">4.8 (24 reviews)</span>
                        </div>
                        <div class="property-price" id="room-price">KES 0/night</div>
                    </div>
                    
                    <div class="property-features">
                        <h3 class="section-title">Room Features</h3>
                        <div class="features-grid" id="room-features">
                            <!-- Features will be loaded here -->
                        </div>
                    </div>
                    
                    <div class="property-description">
                        <h3 class="section-title">Description</h3>
                        <p class="description-text" id="room-description">
                            Loading room description...
                        </p>
                    </div>
                    
                    <div class="host-info">
                        <h3 class="section-title">Your Host</h3>
                        <div class="host-card">
                            <img src="images/prince-alex.png" alt="Prince Alex" class="host-avatar">
                            <div class="host-details">
                                <h4>Prince Alex</h4>
                                <p>Superhost ‚Ä¢ 3 years hosting ‚Ä¢ Speaks English, Swahili</p>
                                <p>Welcome to my place! I'm passionate about providing comfortable accommodations for travelers visiting Uthiru and Nairobi.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="property-sidebar">
                    <div class="booking-card">
                        <div class="booking-header">
                            <div class="booking-price" id="sidebar-price">KES 0</div>
                            <div class="price-period">per night</div>
                        </div>
                        
                        <div class="booking-form">
                            <div class="date-inputs">
                                <div class="input-group">
                                    <label for="checkin">Check-in</label>
                                    <input type="date" id="checkin" name="checkin">
                                </div>
                                <div class="input-group">
                                    <label for="checkout">Check-out</label>
                                    <input type="date" id="checkout" name="checkout">
                                </div>
                            </div>
                            <div class="input-group">
                                <label for="guests">Guests</label>
                                <select id="guests" name="guests">
                                    <option value="1">1 guest</option>
                                    <option value="2">2 guests</option>
                                    <option value="3">3 guests</option>
                                    <option value="4">4 guests</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="price-breakdown" id="price-breakdown">
                            <div class="price-row">
                                <span class="price-label">KES 0 √ó 1 night</span>
                                <span class="price-value">KES 0</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label">Cleaning fee</span>
                                <span class="price-value">KES 500</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label">Service fee</span>
                                <span class="price-value">KES 0</span>
                            </div>
                            <div class="price-row">
                                <span class="price-label total-price">Total</span>
                                <span class="price-value total-price">KES 0</span>
                            </div>
                        </div>
                        
                        <button class="book-btn" onclick="proceedToBooking()">Reserve</button>
                        <p class="booking-note">You won't be charged yet</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Prince Alex Airbnb</h3>
                    <p>Your home away from home in Uthiru, Nairobi</p>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook">üìò</a>
                        <a href="#" aria-label="Instagram">üì∑</a>
                        <a href="#" aria-label="WhatsApp">üì±</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="listings.html">Rooms</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <p>üìç Uthiru, Nairobi, Kenya</p>
                    <p>üìû +254 717 384 875</p>
                    <p>‚úâÔ∏è princealexdigital@gmail.com</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Prince Alex Airbnb. All rights reserved.</p>
                <p class="designer-credit">Designed by <a href="https://www.princealex.pro" target="_blank" rel="noopener">Prince Alex Digital</a></p>
            </div>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
    
    <script>
        const firebaseConfig = { apiKey: "AIzaSyAUNs3WYS2mkvPvzRDfhyZFUbP2XpZjDQg", authDomain: "retailflow-pos-11726.firebaseapp.com", projectId: "retailflow-pos-11726", storageBucket: "retailflow-pos-11726.firebasestorage.app", messagingSenderId: "309314798354", appId: "1:309314798354:web:30784c2b2e7e42168629cb" };
        let firebaseApp, auth, db, storage, currentUser;
        let currentRoom = null;

        function initializeFirebase() {
            if (typeof firebase !== 'undefined') {
                firebaseApp = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                db = firebase.firestore();
                storage = firebase.storage();
                auth.onAuthStateChanged((user) => {
                    currentUser = user;
                    updateNavigationForAuthState(user);
                });
                return true;
            }
            return false;
        }

        function updateNavigationForAuthState(user) {
            const loginBtn = document.getElementById('login-nav-btn');
            const userMenu = document.getElementById('user-menu');
            
            if (user) {
                if (loginBtn) loginBtn.style.display = 'none';
                if (userMenu) {
                    userMenu.style.display = 'block';
                    const userName = document.getElementById('user-name');
                    const userAvatar = document.getElementById('user-avatar');
                    if (userName) {
                        const displayName = user.displayName || 'User';
                        userName.textContent = displayName.split(' ')[0];
                    }
                    if (userAvatar && user.photoURL) {
                        userAvatar.src = user.photoURL;
                    }
                }
            } else {
                if (loginBtn) loginBtn.style.display = 'inline-block';
                if (userMenu) userMenu.style.display = 'none';
            }
        }
        
        function toggleUserMenu() {
            const dropdown = document.getElementById('user-dropdown');
            if (dropdown) {
                dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
            }
        }
        
        async function logout() {
            try {
                await auth.signOut();
                showNotification('üëã Successfully logged out', 'success');
                setTimeout(() => window.location.href = 'index.html', 1000);
            } catch (error) {
                console.error('Logout error:', error);
                showNotification('Error logging out. Please try again.', 'error');
            }
        }

        function initializeMobileNavigation() {
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');
            const body = document.body;
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', function(e) {
                    e.stopPropagation();
                    navMenu.classList.toggle('active');
                    hamburger.classList.toggle('active');
                    body.style.overflow = navMenu.classList.contains('active') ? 'hidden' : 'auto';
                });
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', () => {
                        navMenu.classList.remove('active');
                        hamburger.classList.remove('active');
                        body.style.overflow = 'auto';
                    });
                });
            }
        }

        async function loadRoomData() {
            const roomId = parseInt(localStorage.getItem('selectedRoomId')) || 1;
            
            // Try to load from Firebase first
            if (db) {
                try {
                    const roomDoc = await db.collection('rooms').doc(roomId.toString()).get();
                    if (roomDoc.exists) {
                        currentRoom = { id: roomDoc.id, ...roomDoc.data() };
                        console.log('‚úÖ Room loaded from Firebase:', currentRoom.name);
                    } else {
                        currentRoom = getDefaultRoom(roomId);
                        console.log('üìã Using fallback room data:', currentRoom?.name);
                    }
                } catch (error) {
                    console.error('Error loading room from Firebase:', error);
                    currentRoom = getDefaultRoom(roomId);
                }
            } else {
                currentRoom = getDefaultRoom(roomId);
            }
            
            if (!currentRoom) {
                showNotification('Room not found. Redirecting to rooms page...', 'error');
                setTimeout(() => window.location.href = 'listings.html', 2000);
                return;
            }
            
            displayRoomData();
        }

        function getDefaultRoom(roomId) {
            const defaultRooms = {
                1: { id: 1, name: 'Deluxe Suite', price: 4500, type: 'suite', maxGuests: 2, rating: 4.8, reviews: 24, image: 'https://images.unsplash.com/photo-1631049307264-da0ec9d70304?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', features: ['üõèÔ∏è King Bed', '‚ùÑÔ∏è AC', 'üì∂ WiFi', 'üõÅ Private Bath'], description: 'Experience luxury in our spacious Deluxe Suite featuring a king-size bed, premium amenities, and stunning city views.', images: ['https://images.unsplash.com/photo-1631049307264-da0ec9d70304?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', 'https://images.unsplash.com/photo-1566665797739-1674de7a421a?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', 'https://images.unsplash.com/photo-1618773928121-c32242e63f39?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'] },
                2: { id: 2, name: 'Executive Room', price: 3800, type: 'double', maxGuests: 2, rating: 4.6, reviews: 18, image: 'https://images.unsplash.com/photo-1618773928121-c32242e63f39?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', features: ['üõèÔ∏è Queen Bed', '‚ùÑÔ∏è AC', 'üì∂ WiFi', 'üíº Work Desk'], description: 'Ideal for business travelers, our Executive Room combines comfort with functionality.', images: ['https://images.unsplash.com/photo-1618773928121-c32242e63f39?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', 'https://images.unsplash.com/photo-1566665797739-1674de7a421a?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'] },
                3: { id: 3, name: 'Standard Room', price: 3200, type: 'single', maxGuests: 2, rating: 4.5, reviews: 15, image: 'https://images.unsplash.com/photo-1566665797739-1674de7a421a?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80', features: ['üõèÔ∏è Double Bed', '‚ùÑÔ∏è AC', 'üì∂ WiFi'], description: 'Our comfortable Standard Room offers excellent value with all essential amenities.', images: ['https://images.unsplash.com/photo-1566665797739-1674de7a421a?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'] }
            };
            return defaultRooms[roomId];
        }

        function displayRoomData() {
            if (!currentRoom) return;
            
            document.getElementById('room-breadcrumb').textContent = currentRoom.name;
            document.getElementById('room-title').textContent = currentRoom.name;
            document.getElementById('room-price').textContent = `KES ${currentRoom.price.toLocaleString()}/night`;
            document.getElementById('sidebar-price').textContent = `KES ${currentRoom.price.toLocaleString()}`;
            document.getElementById('room-description').textContent = currentRoom.description;
            
            const ratingStars = '‚òÖ'.repeat(Math.floor(currentRoom.rating)) + '‚òÜ'.repeat(5 - Math.floor(currentRoom.rating));
            document.getElementById('room-rating').textContent = ratingStars;
            document.getElementById('rating-text').textContent = `${currentRoom.rating} (${currentRoom.reviews} reviews)`;
            
            const featuresGrid = document.getElementById('room-features');
            featuresGrid.innerHTML = '';
            currentRoom.features.forEach(feature => {
                const featureItem = document.createElement('div');
                featureItem.className = 'feature-item';
                const [icon, text] = feature.split(' ', 2);
                featureItem.innerHTML = `
                    <span class="feature-icon">${icon}</span>
                    <span>${feature.substring(feature.indexOf(' ') + 1)}</span>
                `;
                featuresGrid.appendChild(featureItem);
            });
            
            const mainImage = document.getElementById('main-image');
            mainImage.src = currentRoom.image;
            mainImage.alt = currentRoom.name;
            
            const thumbnailsContainer = document.getElementById('image-thumbnails');
            thumbnailsContainer.innerHTML = '';
            (currentRoom.images || [currentRoom.image]).forEach((imageUrl, index) => {
                const thumbnail = document.createElement('img');
                thumbnail.src = imageUrl;
                thumbnail.alt = `${currentRoom.name} - Image ${index + 1}`;
                thumbnail.className = `thumbnail ${index === 0 ? 'active' : ''}`;
                thumbnail.onclick = () => changeMainImage(imageUrl, thumbnail);
                thumbnailsContainer.appendChild(thumbnail);
            });
            
            loadSearchCriteria();
            updatePriceBreakdown();
        }

        function changeMainImage(imageUrl, thumbnail) {
            document.getElementById('main-image').src = imageUrl;
            document.querySelectorAll('.thumbnail').forEach(thumb => thumb.classList.remove('active'));
            thumbnail.classList.add('active');
        }

        function loadSearchCriteria() {
            const searchCriteria = localStorage.getItem('searchCriteria');
            if (searchCriteria) {
                try {
                    const criteria = JSON.parse(searchCriteria);
                    if (criteria.checkin) document.getElementById('checkin').value = criteria.checkin;
                    if (criteria.checkout) document.getElementById('checkout').value = criteria.checkout;
                    if (criteria.guests) document.getElementById('guests').value = criteria.guests;
                } catch (e) {
                    console.log('Error loading search criteria:', e);
                }
            }
            
            initializeDateInputs();
        }

        function initializeDateInputs() {
            const checkinInput = document.getElementById('checkin');
            const checkoutInput = document.getElementById('checkout');
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            checkinInput.min = today.toISOString().split('T')[0];
            checkoutInput.min = tomorrow.toISOString().split('T')[0];
            
            if (!checkinInput.value) {
                checkinInput.value = today.toISOString().split('T')[0];
            }
            if (!checkoutInput.value) {
                checkoutInput.value = tomorrow.toISOString().split('T')[0];
            }
            
            checkinInput.addEventListener('change', function() {
                const selectedDate = new Date(this.value);
                const nextDay = new Date(selectedDate);
                nextDay.setDate(nextDay.getDate() + 1);
                checkoutInput.min = nextDay.toISOString().split('T')[0];
                if (new Date(checkoutInput.value) <= selectedDate) {
                    checkoutInput.value = nextDay.toISOString().split('T')[0];
                }
                updatePriceBreakdown();
            });
            
            checkoutInput.addEventListener('change', updatePriceBreakdown);
            document.getElementById('guests').addEventListener('change', updatePriceBreakdown);
        }

        function updatePriceBreakdown() {
            if (!currentRoom) return;
            
            const checkin = document.getElementById('checkin').value;
            const checkout = document.getElementById('checkout').value;
            const guests = parseInt(document.getElementById('guests').value);
            
            if (!checkin || !checkout) return;
            
            const nights = calculateNights(checkin, checkout);
            const subtotal = currentRoom.price * nights;
            const cleaningFee = 500;
            const serviceFee = Math.round(subtotal * 0.08);
            const taxes = Math.round(subtotal * 0.05);
            const total = subtotal + cleaningFee + serviceFee + taxes;
            
            const priceBreakdown = document.getElementById('price-breakdown');
            priceBreakdown.innerHTML = `
                <div class="price-row">
                    <span class="price-label">KES ${currentRoom.price.toLocaleString()} √ó ${nights} night${nights > 1 ? 's' : ''}</span>
                    <span class="price-value">KES ${subtotal.toLocaleString()}</span>
                </div>
                <div class="price-row">
                    <span class="price-label">Cleaning fee</span>
                    <span class="price-value">KES ${cleaningFee.toLocaleString()}</span>
                </div>
                <div class="price-row">
                    <span class="price-label">Service fee</span>
                    <span class="price-value">KES ${serviceFee.toLocaleString()}</span>
                </div>
                <div class="price-row">
                    <span class="price-label">Taxes</span>
                    <span class="price-value">KES ${taxes.toLocaleString()}</span>
                </div>
                <div class="price-row">
                    <span class="price-label total-price">Total</span>
                    <span class="price-value total-price">KES ${total.toLocaleString()}</span>
                </div>
            `;
        }

        function calculateNights(checkin, checkout) {
            const checkinDate = new Date(checkin);
            const checkoutDate = new Date(checkout);
            const timeDiff = checkoutDate.getTime() - checkinDate.getTime();
            return Math.max(1, Math.ceil(timeDiff / (1000 * 3600 * 24)));
        }

        function proceedToBooking() {
            if (!currentRoom) return;
            
            const checkin = document.getElementById('checkin').value;
            const checkout = document.getElementById('checkout').value;
            const guests = document.getElementById('guests').value;
            
            if (!checkin || !checkout) {
                showNotification('Please select check-in and check-out dates', 'warning');
                return;
            }
            
            const searchCriteria = { checkin, checkout, guests, timestamp: new Date().toISOString() };
            localStorage.setItem('searchCriteria', JSON.stringify(searchCriteria));
            localStorage.setItem('selectedRoomId', currentRoom.id);
            
            window.location.href = 'booking.html';
        }

        function showNotification(message, type = 'info') {
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `<div class="notification-content"><span class="notification-icon">${getNotificationIcon(type)}</span><span class="notification-message">${message}</span><button class="notification-close" onclick="this.parentElement.parentElement.remove()">&times;</button></div>`;
            notification.style.cssText = `position: fixed; top: 100px; right: 20px; background: ${getNotificationColor(type)}; color: white; padding: 1rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); z-index: 10000; min-width: 300px; max-width: 400px; animation: slideInRight 0.3s ease;`;
            const content = notification.querySelector('.notification-content');
            content.style.cssText = `display: flex; align-items: center; gap: 10px;`;
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.style.cssText = `background: none; border: none; color: white; font-size: 1.2rem; cursor: pointer; margin-left: auto; padding: 0 5px;`;
            document.body.appendChild(notification);
            setTimeout(() => { if (notification.parentElement) { notification.style.animation = 'slideOutRight 0.3s ease'; setTimeout(() => notification.remove(), 300); } }, 4000);
        }

        function getNotificationIcon(type) { switch(type) { case 'success': return '‚úì'; case 'error': return '‚úó'; case 'warning': return '‚ö†'; default: return '‚Ñπ'; } }
        function getNotificationColor(type) { switch(type) { case 'success': return '#28a745'; case 'error': return '#dc3545'; case 'warning': return '#ffc107'; default: return '#007bff'; } }

        document.addEventListener('DOMContentLoaded', function() {
            if (typeof firebase !== 'undefined') { initializeFirebase(); } else { setTimeout(() => initializeFirebase(), 1000); }
            initializeMobileNavigation();
            loadRoomData();
        });

        const style = document.createElement('style');
        style.textContent = `@keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } } @keyframes slideOutRight { from { transform: translateX(0); opacity: 1; } to { transform: translateX(100%); opacity: 0; } }`;
        document.head.appendChild(style);
    </script>
</body>
</html>
